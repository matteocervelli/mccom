function toggleMobileFilters(){const e=document.getElementById("filters-sidebar"),t=document.body;e.classList.toggle("active"),t.classList.toggle("filters-open"),e.classList.contains("active")&&document.addEventListener("click",function n(s){!e.contains(s.target)&&!s.target.closest(".mobile-filter-button")&&(e.classList.remove("active"),t.classList.remove("filters-open"),document.removeEventListener("click",n))})}function toggleFilter(e){const t=document.querySelector(`[onclick="toggleFilter('${e}')"]`),s=document.getElementById(`${e}-options`),n=t.querySelector(".toggle-icon");t.classList.toggle("active"),s.classList.toggle("active"),t.classList.contains("active")?n.style.transform="rotate(180deg)":n.style.transform="rotate(0deg)"}function getAvailableOptions(e){const n=document.querySelectorAll(".testimonial-card"),t={role:new Set,industry:new Set,department:new Set};return n.forEach(n=>{const o=n.dataset.roles?n.dataset.roles.toLowerCase().split(",").map(e=>e.trim()):[],s=n.dataset.industry?n.dataset.industry.toLowerCase().trim():"",i=n.dataset.departments?n.dataset.departments.toLowerCase().split(",").map(e=>e.trim()):[];(e.industry.length===0||e.industry.includes(s))&&(e.department.length===0||i.some(t=>e.department.includes(t)))&&o.forEach(e=>t.role.add(e)),(e.role.length===0||o.some(t=>e.role.includes(t)))&&(e.department.length===0||i.some(t=>e.department.includes(t)))&&s&&t.industry.add(s),(e.role.length===0||o.some(t=>e.role.includes(t)))&&(e.industry.length===0||e.industry.includes(s))&&i.forEach(e=>t.department.add(e))}),t}function updateFilterOptions(e){const t=getAvailableOptions(e);document.querySelectorAll("#role-options .filter-option").forEach(n=>{const s=n.querySelector('input[type="checkbox"]');if(s.value==="all")return;e.industry.length===0&&e.department.length===0||t.role.has(s.value)?(n.classList.remove("disabled"),s.disabled=!1):(n.classList.add("disabled"),s.disabled=!0)}),document.querySelectorAll("#industry-options .filter-option").forEach(n=>{const s=n.querySelector('input[type="checkbox"]');if(s.value==="all")return;e.role.length===0&&e.department.length===0||t.industry.has(s.value)?(n.classList.remove("disabled"),s.disabled=!1):(n.classList.add("disabled"),s.disabled=!0)}),document.querySelectorAll("#department-options .filter-option").forEach(n=>{const s=n.querySelector('input[type="checkbox"]');if(s.value==="all")return;e.role.length===0&&e.industry.length===0||t.department.has(s.value)?(n.classList.remove("disabled"),s.disabled=!1):(n.classList.add("disabled"),s.disabled=!0)})}function filterTestimonials(){const o=document.querySelectorAll(".testimonial-card"),e=Array.from(document.querySelectorAll('#role-options input:checked:not([value="all"]')).map(e=>e.value.toLowerCase()),t=Array.from(document.querySelectorAll('#industry-options input:checked:not([value="all"]')).map(e=>e.value.toLowerCase()),n=Array.from(document.querySelectorAll('#department-options input:checked:not([value="all"]')).map(e=>e.value.toLowerCase()),s=document.getElementById("search-filter").value.toLowerCase(),i={role:e,industry:t,department:n};o.forEach(o=>{const i=o.dataset.roles?o.dataset.roles.toLowerCase().split(","):[],a=o.dataset.industry?o.dataset.industry.toLowerCase():"",r=o.dataset.departments?o.dataset.departments.toLowerCase().split(","):[],h=o.dataset.search.toLowerCase();console.log("Card:",{name:o.dataset.name,roles:i,industry:a,departments:r,roleFilters:e,industryFilters:t,departmentFilters:n});const c=e.length===0||i.some(t=>e.includes(t.trim())),l=t.length===0||t.includes(a.trim()),d=n.length===0||r.some(e=>n.includes(e.trim())),u=s===""||h.includes(s);console.log("Matches:",{name:o.dataset.name,matchesRole:c,matchesIndustry:l,matchesDepartment:d,matchesSearch:u}),o.style.display=c&&l&&d&&u?"block":"none"}),updateFilterOptions(i)}function clearFilters(){document.querySelectorAll('.filter-option input[type="checkbox"]').forEach(e=>{e.checked=!1,e.disabled=!1,e.closest(".filter-option").classList.remove("disabled")}),document.querySelectorAll('input[value="all"]').forEach(e=>{e.checked=!0});const e=document.getElementById("search-filter");e&&(e.value=""),filterTestimonials()}function sortTestimonials(){const s=document.getElementById("testimonials-container"),t=Array.from(s.getElementsByClassName("testimonial-card")),e=document.getElementById("sort-select").value,n=e=>{try{const t=new Date(e);return isNaN(t.getTime())?(console.error("Invalid date:",e),new Date(0)):t}catch(t){return console.error("Error parsing date:",e,t),new Date(0)}};console.log("Before sorting:",t.map(e=>({name:e.dataset.name,lastmod:e.dataset.lastmod,parsed:n(e.dataset.lastmod).toISOString()}))),t.sort((t,s)=>{switch(e){case"newest":case"oldest":const o=n(t.dataset.lastmod),i=n(s.dataset.lastmod);return console.log("Comparing dates:",{sortType:e,a:t.dataset.name,b:s.dataset.name,dateA:o.toISOString(),dateB:i.toISOString(),comparison:e==="newest"?i-o:o-i}),e==="newest"?i-o:o-i;case"az":return(t.dataset.name||"").localeCompare(s.dataset.name||"");case"za":return(s.dataset.name||"").localeCompare(t.dataset.name||"");default:return 0}}),console.log("After sorting:",t.map(t=>({name:t.dataset.name,lastmod:t.dataset.lastmod,parsed:n(t.dataset.lastmod).toISOString(),sortType:e}))),t.forEach(e=>s.appendChild(e))}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".filter-options").forEach(e=>{e.classList.remove("active")}),document.querySelectorAll(".filter-header").forEach(e=>{e.classList.remove("active");const t=e.querySelector(".toggle-icon");t&&(t.style.transform="rotate(0deg)")}),document.querySelectorAll('.filter-option input[type="checkbox"]').forEach(e=>{e.addEventListener("change",()=>{if(e.value==="all"){const t=e.closest(".filter-options");t.querySelectorAll('input[type="checkbox"]:not([value="all"])').forEach(e=>{e.checked=!1})}else{const t=e.closest(".filter-options").querySelector('input[value="all"]');t&&(t.checked=!1)}filterTestimonials()})});const e=document.getElementById("search-filter");e&&e.addEventListener("input",filterTestimonials),filterTestimonials(),document.addEventListener("click",e=>{const t=document.getElementById("filters-sidebar"),n=document.querySelector(".mobile-filter-button");window.innerWidth<=768&&t.classList.contains("active")&&!t.contains(e.target)&&!n.contains(e.target)&&toggleMobileFilters()});const t=document.getElementById("sort-select");if(t){t.value="newest",sortTestimonials();const e=document.querySelectorAll(".testimonial-card");console.log("Initial testimonials data:",Array.from(e).map(e=>({name:e.dataset.name,lastmod:e.dataset.lastmod,parsedDate:new Date(e.dataset.lastmod).toISOString()})))}})